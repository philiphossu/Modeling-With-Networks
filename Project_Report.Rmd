---
title: "An Investigation Into Modeling With Networks"
subtitle: "Math380 Spring 2018 Project - Code available at https://github.com/philiphossu/Modeling-With-Networks  "
output:
  pdf_document:
    toc: true
author: "Philip Hossu, Paolo Ratti Tamayo, Jiateng Sun"
date: \today
header-includes:
   - \usepackage{bbm}
   - \usepackage{tikz}
   - \usetikzlibrary{arrows}
   - \usetikzlibrary{positioning}
   - \usepackage{amsmath}
   - \usepackage{multirow}
   - \usepackage{algpseudocode}
   - \usepackage{blkarray}
   - \usepackage{esvect}
geometry: margin=1in
fontsize: 12pt

references:
- id: Bloch2016
  title: Centrality Measures in Networks
  author:
  - family: Bloch
    given: Francis
  - family: Jackson
    given: Matthew
  container-title: SSRN Electronic Journal
  URL: 'http://dx.doi.org/10.2139/ssrn.2749124'
  type: article
  issued:
    year: 2016

- id: Segarra2015
  title: Stability and Continuity of Centrality Measures in Weighted Graphs
  author:
  - family: Segarra
    given: Santiago
  - family: Ribeiro
    given: Alejandro
  container-title: IEEE Transactions on Signal Processing
  URL: 'https://doi.org/10.1109/TSP.2015.2486740'
  volume: 64
  issue: 3
  publisher: IEEE Signal Processing Society
  type: article-journal
  issued:
    year: 2015

- id: Karwa2016
  title: Coauthorship and citation networks for statisticians (Comment)
  author:
  - family: Karwa
    given: Vishesh
  - family: Petrović
    given: Sonja
  container-title: arXiv Archives
  URL: 'https://arxiv.org/abs/1608.06667'
  type: article
  issued:
    year: 2016

- id: OscaLluch2009
  title: Co-authorship and citation networks in Spanish history of science research
  author:
  - family: Osca-Lluch
    given: Julia
  - family: Velasco
    given: Elena
  - family: López
    given: Mayte
  - family: Haba
    given: Julia
  container-title: Scientometrics
  URL: 'https://doi.org/10.1007/s11192-008-2089-5'
  volume: 80
  issue: 2
  publisher: Springer Netherlands
  type: article-journal
  issued:
    year: 2009
    
- id: Bonacich2001
  title: Eigenvector-like measures of centrality for asymmetric relations
  author:
  - family: Bonacich
    given: Phillip
  - family: Paulette
    given: Elena
  container-title: Social Networks
  URL: 'https://doi.org/10.1016/S0378-8733(01)00038-7'
  volume: 23
  issue: 3
  type: article-journal
  issued:
    year: 2001
    
- id: Ruhnau2000
  title: Eigenvector-centrality — a node-centrality?
  author:
  - family: Ruhnau
    given: Britta
  container-title: Social Networks
  URL: 'https://doi.org/10.1016/S0378-8733(00)00031-9'
  volume: 22
  issue: 4
  type: article-journal
  issued:
    year: 2000

---
\allowdisplaybreaks


*************************

\newpage

## 1. Introduction

Graphs are some of the most versatile and interesting structures in mathematics. A graph G is characterized as an ordered pair of vertices and edges, $G=(V(G),E(G))$. The edges in a graph imply the existence of a relationship between two vertices or objects. They can be directed (implying a relationship based on ordering) or undirected where the edges have no orientation. Edges can also be weighted, having several real world applications like distance, cost, etc. These structures evidently can represent countless applications which have discrete and related objects. A simple undirected graph which will operate as our running example is shown below.

\tikzset{main node/.style={circle,draw,minimum size=1.25cm,inner sep=1pt},
color2/.style={circle,draw,minimum size=0.65cm,inner sep=1pt,fill = blue!35}}
\begin{center}
\begin{tikzpicture}

  \node[color2] (1) {A};
  \node[color2] (3) [right = 1cm of 1] {C};
  \node[color2] (2) [above = 0.25cm of 3] {B};
  \node[color2] (4) [below = 0.25cm of 3] {D};
  \node[color2] (5) [right = 1cm of 3] {E};
  \node[color2] (7) [right = 1cm of 5] {G};
  \node[color2] (6) [above = 0.25cm of 7] {F};
  \node[color2] (8) [below = 0.25cm of 7] {H};
  \node[color2] (9) [right = 1cm of 7] {I};

 \path[draw,thick]
    (1) edge node {} (2)
    (1) edge node {} (3)
    (3) edge node {} (4)
    (3) edge node {} (2)
    (3) edge node {} (5)
    (6) edge node {} (7)
    (7) edge node {} (8)
    (7) edge node {} (9)
    (5) edge node {} (7);
    
\end{tikzpicture}
\end{center}

Influence is the capacity to produce an effect in indirect or intangible ways. If one wants to be successful in their field, they must share their ideas and persuade their peers to accept them. This idea is present in all types of industries and specializations. We analyze several networks including the Erdos1 co-author network and an actors collaboration network with multiple influence models and discuss their results. 

In the following project report, we analyze how influence can be determined in a graph and describe our exploration into mathematical modeling with networks. We follow mathematical notation given by \textit{A First Course in Mathematical Modeling} by Giordano, Fox and Horton. There exist several known measures to explore the importance of a vertex in a graph, including degree centrality, betweenness centrality, etc. We will model various networks, analyze them, find who/what has the most influence in the network, and describe the reasons behind this result. We seek to combine real world scenarios with some of these mathematical ideas to accurately describe the concept of influence in graphs. Furthermore we will argue how these methods can show steps to rapidly boost ones own influence.

The prompt asked us to consider a number of specific tasks, briefly outlined below:

- Build and analyze the Erdos1 co-author network using the data from https://files.oakland.edu/users/grossman/enp/Erdos1.html. The Erdos1 co-author network is characterized by the authors who have collaborated with the famous mathematician, Paul Erdos. Rather than including every entry in this data file, we were asked to consider a network where each author has collaborated directly with Erdos (omitting Erdos himself). After building this network, we are asked to explore the graph and find some interesting features and properties. 

- Define and study a critical measurement by which to determine the influence of authors in the network we created in part a. 

- Gather data, build, and analyze a network showing the relationship between some foundational papers in the emerging field of network science. Apply the influence measures used for parts a,b and discuss their effectiveness. Also, discuss methodology and other factors surrounding this network. 

- Gather data, build, and analyze a real life scenario which can be modeled as a network. Again apply influence measures and discuss the results, shortcomings, external factors, etc.

- Discuss how influence and impact can be used in real life situations. Consider business decisions, improving influence, selecting a graduate school etc. 

To address the above tasks, we utilized the R programming language and our knowledge from various math and computer science courses. 

## 2. Statement and Analysis of the Problem
While our project does have a number of specific requirements discussed in the introduction, essentially the problem we are trying to approach is how to measure and interpret the influence of a vertex within a network. We define three influence measures to address this problem, discussed in depth in the latter sections. Once these are defined, we are collect and clean multiple data sets, create multiple networks, and analyze these networks under the applicable metrics.

While the field of graph theory is certainly not young, we noticed a wealth of more recent works geared towards our topic and more general social network analysis. We began by finding a modern survey of various graph centrality measures, notably the work titled \textit{Centrality Measures in Networks} [-@Bloch2016]. Rather than focusing on a concrete example, this work provides a much needed overview of several fundamental graph measurements and their properties. This publication helped us determine what different types of graph metrics exist and how they are calculated. This was not the only publication which we considered to help us learn about various graph metrics. The work by Segarra and Ribeiro titled \textit{Stability and Continuity of Centrality Measures in Weighted Graphs} gave us an insight into some of the advantages and disadvantages of metrics like Eigenvector centrality and Betweenness centrality [-@Segarra2015].

Another work which we used to help shape our understanding of the problem was the comment released by Karwa and Petrovic titled \textit{Coauthorship and citation networks for statisticians} [-@Karwa2016]. This paper looks directly at how co-author networks and citation networks can be analyzed which is very relevant to our project. Regrettably, the networks and paper which Karwa and Petrovic are commenting on are more advanced than what we are able to make. Consequently, their analysis is also more advanced. As we will discuss, our Erdos1 co-author network is slightly oversimplified. An edge in our network simply implies the presence of these two authors collaborating at least once, but the exact number is unknown. We not able to give weights to our edges since our data set simply shows some form of collaboration. Regardless, we were able to take a number of pointers from this paper. For a complex network, the paper suggests that a metric like counting the degree of each node is far too simple. For our simple network, such a measure may be more appropriate. 

A number of publications also exist which analyze specific co-author networks. One such work is \textit{Co-authorship and citation networks in Spanish history of science research} by Osca-Lluch, et al [-@OscaLluch2009]. The author's data allows them to look at papers published by various journals, number of papers published by Spanish scientists over time, types of publications, etc. While we did not have this type of data readily accessible, the paper also looks at co-author collaboration and the impact of these publications. The paper interestingly notes that a very high percentage of authors have no collaboration whatsoever. They create a visualization of their graph where the thickness of each edge represent number of collaborations between two authors. To analyze the impact of a publication, the authors weigh in on using a quantitative measurement vs a qualitative one. They argue that a qualitative approach can be effective due to its ability to take into consideration the expertise, reach, and prestige of a researcher and their written work separately from the journal which they published in. 

Despite that our networks were based on much more simple data sets, it was interesting and useful to see how others have approached similar analyses of co-author and citation networks. This problem is not totally novel, but it's apparently getting increasing amounts of attention, as we were able to find several publications referencing co-author and citation networks in the last 10 to 15 years. 

## 3. Description of the Model
We selected three primary models by which to determine influence in a graph. While these metrics are not entirely novel, we explain their formulation both mathematically and conceptually. 

###3.1 Total Degree
The degree of a vertex v, commonly denoted $deg(v)$, represents the number of edges incident to the vertex. This calculation can vary slightly depending on if the graph is directed or undirected. For the purpose of our application, we choose our measurement to be the total degree of a vertex, where total degree is defined as follows:

For a directed graph $G=(V(G),(E(V))$, Total Degree of a vertex v = $\sum\limits_{}edges \ in \ (v) + \sum\limits_{}edges \ out \ (v)$ where edges in (v) represents the incident edges directed into a vertex v and edges out (v) represents the incident edges directed out of the vertex v. 

For an undirected graph, the Total Degree of a vertex v is simply $\sum\limits_{}edges \ incident \ to \ (v)$. 

We show an example calculation of the total degree of each node in a simple graph below. Note that the degree of each vertex is written inside the vertex next to the label. 

\begin{center}
\begin{tikzpicture}

  \node[color2] (1) {A(2)};
  \node[color2] (3) [right = 1cm of 1] {C(4)};
  \node[color2] (2) [above = 0.25cm of 3] {B(2)};
  \node[color2] (4) [below = 0.25cm of 3] {D(1)};
  \node[color2] (5) [right = 1cm of 3] {E(2)};
  \node[color2] (7) [right = 1cm of 5] {G(4)};
  \node[color2] (6) [above = 0.25cm of 7] {F(1)};
  \node[color2] (8) [below = 0.25cm of 7] {H(1)};
  \node[color2] (9) [right = 1cm of 7] {I(1)};

 \path[draw,thick]
    (1) edge node {} (2)
    (1) edge node {} (3)
    (3) edge node {} (4)
    (3) edge node {} (2)
    (3) edge node {} (5)
    (6) edge node {} (7)
    (7) edge node {} (8)
    (7) edge node {} (9)
    (5) edge node {} (7);
    
\end{tikzpicture}
\end{center}

By the total degree metric, we would say that the most important/influential vertices in this graph would be C and G, each having a degree of 4. These vertices have the most direct connections to the other vertices in the network.

Another way to visualize this graph and consider the degree of each vertex is via an adjacency matrix. This is a V x V matrix where the value of each entry denotes the presence or absence of an edge between the two corresponding vertices. The value in each entry can be modified to contain the edge weight, but this is not applicable in the networks we are analyzing. The corresponding adjacency matrix for our running example is shown below. 

\[
\begin{blockarray}{cccccccccc}
A & B & C & D & E & F & G & H & I \\
\begin{block}{(ccccccccc)c}
  0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & A \\
  1 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & B \\
  1 & 1 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & C \\
  0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & D \\
  0 & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 0 & E \\
  0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & F \\
  0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 1 & G \\
  0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & H \\
  0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & I \\
\end{block}
\end{blockarray}
\]

From this adjacency matrix, we can confirm the total degree counts of each vertex. Looking at vertex G for example, taking the summation of the G row and G column both yield the degree of 4 which we were previously able to calculate visually. In a directed graph, a similar approach can be taken but accounting for the fact that the matrix would no longer be symmetric about the main diagonal. 

We selected the total degree metric metric due to its simplicity and relevance in the example networks which we will consider. However, this metric doesn't always give a full picture of the influence in a network. 

###3.2 Eigenvector Centrality
The eigenvector centrality of a vertex in network is a more advanced measurement which can help determine influence of a vertex. While this measurement also suggests that the importance of a vertex depends on the vertices it is directly connected to, it adds a layer of complexity. Rather than considering the number of incident edges to a vertex, eigenvector centrality suggests that the importance of a vertex is relative to the importance of the vertices it is connected with [@Ruhnau2000]. 

This metric is based on the general eigenvector problem, defined as follows: The eigenvalues and eigenvectors of a square mxm matrix are the scalar values $\lambda$ and vectors $\vv{x}$ respectively that are the solutions to:

$$A \vv{x}= \lambda \vv{x}$$
Now, applying this problem specifically to graph centrality, the eigenvector centrality is defined as follows: Given a graph $G=(V(G),E(G))$ and its corresponding adjacency matrix A, the score of a vertex $X_v$ is calculated as follows with M(v) representing the set of neighbors of the vertex v $\in V(G)$. The specific value of lambda can be calculated via power iteration. 

$$ X_v = 1/\lambda \sum_{t\in M(v)} X_t$$

We utilize the igraph package in R which provides an easy to use interface through which to perform this calculation. The following code block demonstrates the calculation on our example using igraph.

```{r message=FALSE, fig.align="center"}
# Loading Package
library('igraph') 
# Creating edge list, vertex list
example_edges <- data.frame(x=c("A","A","B","C","C","E","G","G","G"),
                    y=c("B","C","C","D","E","G","F","I","H"))
example_vertices <- data.frame(x=c("A","B","C","D","E","F","G","H","I"))
# Generating network
net <- graph_from_data_frame(d=example_edges,vertices=example_vertices,
                             directed=F) 
# Plotting network
plot(net,vertex.size=20,margin=0,edge.arrow.size=0.3,vertex.color="gray75")
# Calculate Eigenvector Centrality of each Vertex
EGvals <- eigen_centrality(net)$vector
sort(EGvals, decreasing=TRUE)

```

Eigenvector centrality has several advantages over using a more simple approach like the total degree of a vertex. A vertex having many incident edges doesn't necessarily have a higher eigenvector centrality, which differs from total degree centrality and arguably more accurately measures the importance (influence) of nodes. We can see in the above example that using eigenvector centrality, the importance of the nodes is different from the degree approach. Even though vertices D and H both have degree 1, eigenvector centrality acknowledges that D is the more important vertex because it's connected to C which is is also a more important vertex in the graph. Eigenvector centrality recognizes that vertices in an interconnected component are more important than vertices which are weakly connected. We also see that even though E has a degree of 2 compared with the degree 4 of G, eigenvector centrality finds E to be the more important vertex because it is connected to very important components.   

The primary disadvantage with Eigenvector centrality is that it's geared towards undirected graphs which consequently have symmetric adjacency matrices. Eigenvector centrality is very applicable to our undirected network scenarios like the Erdos1 network and the actor collaboration network. However, when it comes to the citation network, we will use a third metric to determine the influence of a node. 

###3.3 Alpha Centrality
Alpha centrality adds a new consideration to Eigenvector centrality to allow the metric to be applied to directed graphs which have asymmetric adjacency matrices [@Bonacich2001]. Given a graph $G=(V(G),E(G))$ and its corresponding adjacency matrix A, alpha centrality is defined as follows where e is the importance given to a vertex and alpha is a constant: 

$$\vv{x} = (I-\alpha A^T)^{-1}\vv{e} $$

Alpha centrality begins by giving every vertex a starting random positive amount of influence. The algorithm divides the influence each node has and updates the relative influence of its outward neighbors while also receieving influence from its inward neighbors based on the alpha coefficient. As the alpha parameter decreases, the significance of a directed edge is larger in the calculation. This process repeats until the graph reaches a steady state, perhaps through power iteration. Once this is achieved, we are returned the relative ranks of the vertices in the graph based on their centrality scores. 

## 4. Analysis and Testing of the Model

###4.1 Aside: Data Cleaning & Network Creation Using iGraph Package

Before we could test any of our influence metrics, we had to collect, clean, and import data into R. The raw data for the Erdos1 collaborator network (found at https://files.oakland.edu/users/grossman/enp/Erdos1.html) is a 1 column by ~19000 row document that contains one name in each row. The authors who collaborated directly with Erdos have no spaces before them. Each direct collaborator is followed by a variable number of entries which begin with a set number of spaces. Each of these represent a collaborator of the direct collaborator of Erdos. We had to create an algorithm to parse this file, the pseudocode of which can be seen below:

\begin{algorithmic}
\State{Initialize $currentMain \gets ""$, Initialize $df$ to store all the vertices}
\State{Open data file}
\State{$currentMain \gets $ First Level 1 Collaborator (first line in file)}
\While{File is not empty}
    \State{Read next line }
    \If{Line is empty}
      \State{Level 1 collaborator has no more Level 2 collaborators}
      \State{$currentMain \gets$ Next Level 1 Collaborator}
    \Else 
      \State{Create an entry with currentMain and his next collaborator}
      \State{Append the new entry to df}
    \EndIf
\EndWhile
\State{Close file}
\State \Return{$df$}
\end{algorithmic}

To create the actual networks in R, we utilize the iGraph package available at http://igraph.org/r/. In order to create an igraph network object, we need to provide a two column edge list, where the first column represents the "from" vertex and the second column represents the "to" vertex. We also must create and specify a vertex list containing all of the unique vertices. Each of these data frames can have subsequent columns containing extra data about each edge/vertex like weight, etc. Given these pieces of information, we can create, visualize, and run calculations on directed and undirected networks.

In the following sections we focus primarily on describing the results of our testing with irrelevant code blocks being run but hidden from view. Our full code can be found at https://github.com/philiphossu/Modeling-With-Networks. 

###4.2 Exploring the Erdos1 Co-author Network

Here, we create the Erdos1 co-author network after cleaning and importing the data. We make this network undirected since the data which we have only shows some form of collaboration between authors. Prior to testing our metrics on this network, we explore some of the interesting properties of this network as suggested in the project requirements. 

```{r, include=FALSE}
processFile = function(filepath) {
  # Current Main represents the Erdos1 collaborator
  currentMain <- ""
  df <- data.frame()
  con = file(filepath, "r")
  # Open file, read first main collaborator
  line = readLines(con, n = 1)
  words <- strsplit(line, " ")[[1]]
  temp <- gsub('[0-9:* \"]+', '', words)
  currentMain <- paste(words <- temp[which(temp != '')], collapse = ' ')
  
  while (TRUE) {
    line = readLines(con, n = 1)
    # print(line)
    # If EOF, break
    if (length(line) == 0) {
      break
    }
    # If empty line, read next main collaborator
    if (line == ''){
      line = readLines(con, n = 1)
      words <- strsplit(line, " ")[[1]]
      temp <- gsub('[0-9:* \"]+', '', words)
      currentMain <- paste(words <- temp[which(temp != '')], collapse = ' ')
    } else{
      # Record Erdos2 collaborators and their corresponding main collaborator
      words <- strsplit(line, " ")[[1]]
      temp <- gsub('[0-9:* \"]+', '', words)
      words <- paste(words <- temp[which(temp != '')], collapse = ' ')
      currentDF <- data.frame(currentMain,words)
      df <- rbind(df,currentDF)
    }
  }
  close(con)
  # df column 1 = main collaborators (from), column 2 = secondary collaborators (to)
  return(df)
}
result <- processFile("~/Desktop/School/MATH380/Modeling-With-Networks/erdos1data.csv")
colnames(result) <- c("Main/From", "Secondary/To")

uniqueE1People <- unique(result$`Main/From`)

# Now we need to go through our data frame and remove all the edges which are not between Erdos1 authors
a <- 1
indicesToRemove <- c()
for(a in 1:nrow(result)){
  #print(result[a])
  if(!(result[a,2] %in% uniqueE1People)){
    indicesToRemove <- c(indicesToRemove,a)
  }
}

# indicesToRemove contains the edges which we don't care about, Erdos2 authors, removing them here
result <- result[-indicesToRemove,]
# Obtaining all nodes for creation of the iGraph object
nodes <- unique(result$`Main/From`)
```

```{r, echo=TRUE}
erdos1_network <- graph_from_data_frame(d=result, vertices=nodes, 
                                        directed=F) 
erdos1_network <- simplify(erdos1_network, remove.multiple = TRUE)
length(V(erdos1_network)) # Number of vertices in the graph
length(E(erdos1_network)) # Number of edges in the graph
```

We see that this network consists of 474 vertices and 1663 edges -- a relatively large network. It is worth noting that our network does not contain all 511 erdos1 authors because go through our data frame and remove all the edges which are not between Erdos1 authors as instructed. 

The first aspect of the graph we looked at is the presence of cliques. A clique is a subset of vertices where each vertex is connected to every other vertex. A simple example of a clique would be a triangle which has three vertices connected by three edges. In terms of our network, the real world meaning of a clique in our network would be a set of authors who all collaborated with each other at some point in their careers. Simply calculating the total number of cliques larger than 3 in our network returns in a data set far larger than is valuable. 

```{r, include=FALSE}
cliquesFound <- cliques(erdos1_network, min = 3, max = NULL) 
length(cliquesFound) # Lots of cliques of size 3 or larger
```

However, we can also find only the largest cliques present in the graph and plot one of these largest cliques, shown in the code segment below.

```{r, echo=TRUE, fig.align="center"}
# List of biggest cliques
biggestCliquesFound <- largest_cliques(erdos1_network) 
# Number of largest cliques present
length(biggestCliquesFound) 
# Visualizing one of the large cliques
clique1 <- biggestCliquesFound[[1]]
cliqueNetwork <- induced.subgraph(graph=erdos1_network,vids=clique1)
plot(cliqueNetwork, edge.arrow.size=.01,vertex.size=1,margin=0,
     layout=layout_in_circle, vertex.label.family="Helvetica")
```

Another property of the graph which we explored was the diameter of the graph. The diamter of a graph is the longest path present in the graph. 

```{r}
get.diameter(erdos1_network) # Show the longest path 
```

While this metric doesn't have a lot of real world meaning in terms of determining influence, it's still an interesting graph property to explore. It's possible that the authors on either end of this longest path would have very different academic works but are somehow connected through this longest path due to their co-authors. 

Edge density is also an interesting calculation relevant to our network. This is defined as the ratio of number of edges in the graph over all of the possible edges, and is caluclated below.  

```{r}
edge_density(erdos1_network) # Show the density calculation result
```

Given our 1663 total edges and 474 vertices, the result of this calculation is accurate We see here that compared to the possible connectedness of the graph, the Erdos1 co-author network is fairly sparse. 

The last property we considered was the clustering coefficient in the graph. The clustering coefficient measures locally how connected the vertices are. The definition of clustering is fairly fluid as clustering algorithms take several parameters, but generally speaking clustering seeks to find groups of similar vertices. 

```{r}
# Show the clustering coefficient calculation result
transitivity(erdos1_network) 
```

This number shows the probability that an author's co-authors have collaborated together. This metric also shows us how connected the vertices in the graph are, and given the lower result, we see that this probability is not high. 

###4.3 Testing the Erdos1 Co-author Network

Since we created this network in the previous section, we can begin by calculating the total degree of each vertex, shown in the code segment below. 

```{r}
totalDegree <- degree(erdos1_network, v = V(erdos1_network), mode = c("all") 
                      ,loops = TRUE, normalized = FALSE)
head(sort(totalDegree, decreasing=TRUE))
```

According to the total degree method, the most important authors in the Erdos1 co-author network are NOGA M. ALON, BELA BOLLOBAS, RONALD LEWIS GRAHAM, etc. We are told here that the authors who have the highest degree, or most collaborators, are the most important. However, as shown in our running example, the degree centrality doesn't necessarily give the full picture. 

Next, we can calculate the eigenvector centrality, our second model, which assigns importance to an author based on the importance of the authors who they are connected with.

```{r}
eigenValues <- eigen_centrality(erdos1_network)$vector
head(sort(eigenValues, decreasing=TRUE))
```

Based on the eigenvector centrality model, the most important Erdos1 co-authors are NOGA M. ALON, VOJTECH RODL, BELA BOLLOBAS, etc. 

```{r, include=FALSE}
pal <- colorRampPalette(c("blue","green","yellow","orange","red"))
graphCol <- pal(50)[as.numeric(cut(eigenValues,breaks=50))]
```

We can also create a visualization of the network where the color of each vertex represents its eigenvector centrality, shown in Figure 1. The cooler the color, the lower the eigenvector centrality (red is most important, blue is least important).

```{r, echo=FALSE, fig.height=10, fig.width=10, fig.cap="Eigenvector Centrality Heatmap for Erdos1 Network"}
plot(erdos1_network, vertex.color=graphCol, edge.arrow.size=.001, edge.size=0.1,vertex.label=NA,vertex.size=2.5,margin=0)
```

We see some similarities and differences between the outputs of our two models. We look specifically at the rankings of "VOJTECH RODL" and "RONALD LEWIS GRAHAM" in the degree model vs the eigenvector model. In the degree model, Ronald Lewis Grahm is considered more important or influential because he has 44 connections to other authors vs the 43 connections of Vojtech Rodl. However, the eigenvector centrality shows that Rodl is in fact the more influential figure in this network because the individuals he is connected with are themselves more influential. The code below shows that in terms of eigenvector centrality, Graham's connections are less important than Rodl's. We find Graham's and Rodl's respective neighborhoods and then take the mean of their neighbor's eigenvector centrality. 

```{r}
graham_connections <- which(names(eigenValues) %in% neighbors(erdos1_network
                      ,"GRAHAM, RONALD LEWIS", mode = c("total"))$name) 
# Find eigenvector centrality values for Graham neighborhood
mean(eigenValues[graham_connections])

rodl_connections <- which(names(eigenValues) %in% neighbors(erdos1_network
                      ,"RODL, VOJTECH", mode = c("total"))$name) 
# Find eigenvector centrality values for Rodl neighborhood
mean(eigenValues[rodl_connections])
```

From the above output, it's clear that even though Rodl's degree is lower, his influence is larger in the network. 

Alpha centrality calculation is not relevant for this network because the Erdos1 graph's edges are undirected. 

###4.4 Testing the Citation Network

To build this network, we first had to manually create a csv citation data set consisting of a directed edge list. We started with the paper titled \textit{On Random Graphs} by Paul Erdos and Alfred Renyi. Using Google Scholar, we looked at all the papers which cited this work. Due to the large number of papers which cited this and subsequent papers, we decided to scale down this network. Since many of the papers on our list had between 500 and 3000 ciations, we chose to scale down the data by a factor of 500. In other words, if paper A was cited 3000 times, we award it 6 edges to the top papers which cited it. By scaling the network this way, we were able to maintain the behavior of the data in a manageable way. The data set which we created is available in the included citationNetwork.csv file. 

```{r, include=FALSE}
citation_edges <- read.csv("~/Desktop/School/MATH380/Modeling-With-Networks/citationNetwork.csv")
citation_vertices <- data.frame(vertices=unique(citation_edges[,1]))
firstVertex <- data.frame(vertices=as.character(unlist(citation_edges[1,2])))
citation_vertices <- rbind(citation_vertices, firstVertex)
```

We create the citation network using this data in the following code.

```{r}
citation_network <- graph_from_data_frame(d=citation_edges[,1:2], 
                      vertices=citation_vertices, directed=T) 
length(V(citation_network)) # Number of vertices in the graph
length(E(citation_network)) # Number of edges in the graph

```

We see that the citation network consists of 81 vertices and 107 edges. In this network, the vertices represent each paper, and a directed edge represents a paper citing (or being cited by) another paper. 

Now, we can apply our first model to this network. The following code returns the total degree for each vertex in the network. We then sort the results in decreasing order, and display the six vertices with the highest total degree.

```{r}
total_citation_degree <- degree(citation_network, v = V(citation_network), 
                        mode = c("all"), loops = TRUE, normalized = FALSE)
head(sort(total_citation_degree, decreasing=TRUE))
```

According to the total degree method, \textit{The Structure and Function of Complex Networks (TSFCN)} is the most influential paper in the network, since it cites and it is cited the most times. However, as explained before, total degree does not take into consideration the influence of each citation, just the presence of one. To do this, we apply our second model which calculates eigenvector centrality for each vertex in the network, and display the top entries in decreasing order.

```{r}
eigen_values <- eigen_centrality(citation_network)$vector
head(sort(eigen_values, decreasing=TRUE))
```

According to the eigenvector centrality, \textit{TSFCN} is also the most influential paper in the citation network. A plot for the network is provided below, where the vertices are colored based on their eigenvalues where a higher eigenvalue is mapped to a warmer color.

```{r, include=FALSE}
pal <- colorRampPalette(c("blue","green","yellow","orange","red"))
graphCol <- pal(50)[as.numeric(cut(eigen_values,breaks=50))]
```

```{r fig.cap="Eigenvector Centrality Heatmap for Citation Network", fig.height=10, fig.width=10, message=FALSE, warning=FALSE}
plot(citation_network, vertex.color=graphCol, edge.arrow.size=1, 
     edge.size=NA,vertex.label=NA,vertex.size=5,margin=0)
```

\textit{TSFCN} (shown in red) is connected to 38 papers which is the reason that it has a really large influence according to the total degree model. Because of the relative influence of these 38 papers, eigenvector centrality also finds this paper to be very important. However, we want to take into consideration the direction of these 38 edges to get a better gauge on the influence of the paper. \textit{TSFCN} has 34 papers which cited it (in degree) and 4 papers which it cites (out degree). Alpha centrality, our third model, splits the influence \textit{TSFCN} has over the four papers that it cites, giving those a higher influence. 

The following code calculates the alpha centrality values for the citation network. We select the alpha parameter to be 0.5.

```{r}
citation_alpha <- alpha_centrality(citation_network, 
    nodes = V(citation_network), alpha = 0.5, loops = FALSE)
head(sort(citation_alpha, decreasing=TRUE))
```

According to the alpha centrality, \textit{On Random Graphs} is the most influential paper in the network. We see this paper in red reflected in figure 3. This result makes sense because of the way in which we built the citation network. We expect \textit{On Random Graphs} to be the most influential paper because it's the paper which we chose to build our network on. All papers in the network point to this work, both directly and indirectly. 

```{r, include=FALSE}
colorRampPalette(c("blue","green","yellow","orange","red"))
graphCol <- pal(5000)[as.numeric(cut(citation_alpha,breaks=5000))]
```

```{r fig.cap="Alpha Centrality Heatmap for Citation Network", fig.height=10, fig.width=10, message=FALSE, warning=FALSE}
plot(citation_network, vertex.color=graphCol, edge.arrow.size=1, 
     edge.size=NA,vertex.label=NA,vertex.size=5,margin=0)
```


###4.5 Testing the Actors Network

```{r, include=FALSE}
movieData <- read.csv("~/Desktop/School/MATH380/Modeling-With-Networks/movie_metadata.csv")

#Removing duplicate rows
movieData <- movieData[!duplicated(movieData),]

actorAList <- c()
actorBList <- c()

#For every row (movie) in the data
for (i in 1:nrow(movieData)){
  actors <- movieData[i,]
  #For every name (actor) in the row
  for (j in 1:ncol(movieData[i,])){
    #For every other name than j in the column 
    for (k in 1:ncol(movieData[i,])){
      if(as.character(unlist(movieData[i,j])) != as.character(unlist(movieData[i,k]))){
        #tempDF <- data.frame(actorA=as.character(unlist(movieData[i,j])),actorB=as.character(unlist(movieData[i,k])))
        #actorCollabDF <- rbind(actorCollabDF, tempDF)  
        actorAList <- c(actorAList, as.character(unlist(movieData[i,j])))
        actorBList <- c(actorBList, as.character(unlist(movieData[i,k])))
     }
    }
  }
}

#Creating the actorA - actorB dataframe
actorCollabDF <- data.frame(actorA=actorAList, actorB=actorBList)

#Igraph
#Getting the nodes
actorsNodes <- unique(actorCollabDF$actorA)

```

After importing and processing the data for this graph (omitted from our report), we begin by creating the actors collaboration network. The data we used is available at https://www.kaggle.com/sudheersankar/movie-metadata/data. This is a sizeable data set which contains entries about various modern movies. We clean this data to focus on just the actors who are collaborating in a certain film, though the data contains other potentially interesting data about critic ratings, Facebook likes, etc. which could be utilized in further analysis. 

```{r}
actorsNetwork <- graph_from_data_frame(d=actorCollabDF, 
vertices=actorsNodes, directed=F)
length(V(actorsNetwork)) # Number of vertices in the graph
length(E(actorsNetwork)) # Number of edges in the graph
```

The number of vertices in the actor/collaborator network 6256 and the number of edges is 29286 in the actor network. Figure 4 shows a visualization of this large network.

```{r, fig.height=10, fig.width=10, fig.cap="Actors Network"}
plot(actorsNetwork, vertex.color="cornflowerblue", edge.arrow.size=.001, 
     edge.size=0.1,vertex.label=NA,vertex.size=2,margin=0)
```

Similar to the analysis of the erdos co-author network, we start with a primary approach of determining each actor's influence: each node's degree represents that actor's influence.

```{r}
totalDegree <- degree(actorsNetwork, v = V(actorsNetwork), mode = c("all"), 
                      loops = TRUE, normalized = FALSE)
head(sort(totalDegree, decreasing=TRUE))
```

Our calculation suggests that Robert De Niro had collaborated with 200 actors, Morgan Freeman had collaborated with 172 other actors, etc. In this model, Mr. De Niro has the most influence within this network. 

As mentioned before, total degree centrality awards one centrality point for every link a node receives, but not all vertices are equivalent. In other words: a node is connected to more nodes does not mean it has more influence. Instead, a node is important if it is linked to by other important nodes, which is eigenvector centrality's thesis.

```{r}
eigenValues <- eigen_centrality(actorsNetwork)
head(sort(eigenValues$vector, decreasing=TRUE))
```

According to the result of our eigenvector centrality calculation, Morgan Freeman has the most influence with 1.0000000 followed by Robert De Niro with 0.9949732.

```{r, include=FALSE}
pal <- colorRampPalette(c("blue","green","yellow","orange","red"))
graphCol <- pal(50)[as.numeric(cut(eigenValues$vector,breaks=50))]
```

We can see that although Robert De Niro has collaborated with 28 more actors than Morgan Freeman, Morgan Freeman has a higher eigenvector centrality score which means Morgan Freeman is more influencial than Robert De Niro. To justify this result, we find Freeman's and De Niro's respective neighborhoods and then take the mean of their neighbor's eigenvector.

```{r, include=FALSE}
eigenValuesNum <- eigen_centrality(actorsNetwork)$vector
```


```{r}
MorgenFreeman <- which(names(eigenValuesNum) %in% neighbors(actorsNetwork, 
"Morgan Freeman", mode = c("total"))$name)
# Find eigenvector centrality values for Freeman neighborhood
mean(eigenValuesNum[MorgenFreeman])

RobertDeNiro <- which(names(eigenValuesNum) %in% neighbors(actorsNetwork, 
"Robert De Niro", mode = c("total"))$name)
# Find eigenvector centrality values for De Niro neighborhood
mean(eigenValuesNum[RobertDeNiro])
```


From this calculation, Morgan Freeman's collaborators has a higher average eigenvector centrality score, which means his collaborators, on average, are more influencial than Robert De Niro's. This results in Morgan Freeman having a higher eigenvector centrality score although he collaborated with fewer actors.

Alpha centrality calculation is not relevant for this network because the Actor Collaborator graph's edges are undirected. 

## 5. Results and Quality of the Models

###5.1 Discussion on Erdos Co-author Network
Our entire analysis of this network relies on the assumption that an authors influence can be determined by who they have collaborated with. We applied the total degree model and the eigenvector centrality model to the Erdos1 co-author network. As previously shown, both models produced meaningful results. The authors which the models have selected to be most influential somewhat overlapped, but the order in which these authors were ranked changed slightly. This change in rank is due to the different calculations and assumptions which each model performs to determine influence. 

The total degree model is primarily strong in terms of simplicity of computation and interpretation. The results simply show how many edges are adjacent to each vertex and we ordered these in descending order to see the most important authors. In the context of the total degree method, an author who has more co-authors arguably has more influence on his/her circle because of the increased number of interactions with researchers who could be from different fields, backgrounds, nationalities, etc. However, the strength for this model can also arguably be its weakness. The assumption that more collaborators implies more influence may be an oversimplification of the real scenario. If an author collaborates 100 times with authors who only end up writing one academic work in their lives, this is arguably not as influential as an author who collaborated 50 times with well known academics. 

Eigenvector centrality addresses this dilemma in a way which is applicable to our undirected co-author network. The advantage of this method is to take into consideration the importance of an author's collaborators when assigning influences. However, the complex computation in this method makes the results more difficult to interpret. The actual values resulting from the eigenvector centrality computation don't have much meaning in terms of the application. We know the result consists of numbers between 0 and 1, but all they tell us is the relative importance rankings of the authors. While this is the question we sought to answer, we get less supporting information and have to perform further analysis to determine why these rankings were assigned. This is in contrast to the clear results of the total degree model which simply returns the number of collaborators an author had.

It is worth noting that our results are based on a simple network in which we only know the presence of a collaboration between two authors. Having a value of the number of times which authors collaborated would have given us a more interesting analysis and more largely favored the Eigenvector centrality model. 

###5.2 Discussion on Citation Network
To be completed

###5.3 Discussion on Actors Network
To be completed

###5.4 Overall Conclusions
To be completed

## 6. Future Work
While our project covers three models for influence in a static snapshot of a network, an additional interesting investigation would be to see how accurate our influence metrics are for predicting future states of a network. Take for example our paper citation network. We determined that of our models, alpha centrality is the most comprehensive metric for determining influence of an academic work. Given more time and resources, it would be interesting to do the following: 
\begin{enumerate}
\item Create a larger scale citation network
\item Run models on the network
\item After some time has passed (perhaps a year) create an updated version of the network, adding the new papers which have been written and cited already present papers in the network
\item Re-run metrics on the updated network
\end{enumerate}
Performing the above process would give us some interesting insight into how effective our centrality measures were in predicting the future behavior of a graph of this kind. Could we treat alpha centrality or eigenvector centrality as a sort of probability of a new edge being attached to that vertex in the next state of the graph? Intiutively we may assume that there is a relationship, but further testing and analysis would be required to have concrete evidence of this. 

Another interesting future project would be to analyze networks which have more complex attributes. In many of our networks, we are analyzing simple edges and vertices. However, the presence of more advanced metadata in terms of the edges and vertices could reveal interesting properties of the graphs and/or shortcomings of our models. We may be able to further validate the results of our graphs given a more in depth data set. 

A final future goal would be to use the knowledge which we have gained from this project (and potentially a future course on graph theory) to build an original model to define influence in a network. Our report contains a comprehensive analysis of three leading approaches, but it would be interesting to revisit this problem given more experience and develop our own influence metric.



## References
